<!doctype html>
<html>
	<head>
		<title><%= meta[0].name %> - PollEndpoint</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="keywords" content="<%= meta[0].keywords %>" />
		<meta name="description" content="<%= meta[0].desc %>">
		<link type="text/css" href="../assets/css/bootstrap.min.css" rel="stylesheet">
		<link type="text/css" href="../assets/css/bootstrap-responsive.min.css" rel="stylesheet">
		<style type="text/css">
		body {
			padding-top: 20px;
			padding-bottom: 40px;
		}
		
		/* Custom container */
		.container-narrow {
			margin: 0 auto;
			max-width: 700px;
		}
		.container-narrow > hr {
			margin: 30px 0;
		}
		
		/* Main marketing message and sign up button */
		.jumbotron {
			margin: 20px 0;
			padding: 1em;
			text-align: center;
			box-shadow: 0px 0px 3em #ccc inset, 0px 0px 20px 5px #ccc;
		}
		.jumbotron h1 {
			font-size: 72px;
			line-height: 1;
		}
		.jumbotron .btn {
			font-size: 21px;
			padding: 14px 24px;
		}
		
		/* Supporting marketing content */
		.marketing {
			margin: 60px 0;
		}
		.marketing p + h4 {
			margin-top: 28px;
		}
		.question {
			border-bottom: #ccc 1px solid;
			padding: 1em;
			margin-bottom: 1em;
		}
		label.error {
			color: red;
			position:relative;
			left: 2em;
			top: 0;
		}
		</style>
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.js"></script>
		<script type="text/javascript" src="../assets/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="../assets/js/jquery.form.js"></script>
		<script type="text/javascript" src="../assets/js/jquery.validate.min.js"></script>
		<script>
		$(function(){
			$('#answer').validate({
				submitHandler:function(form){
					$('#answer').ajaxSubmit({
						dataType:'json',
						success:function(data){
							if(data.success){
								window.location.href = "/thanks";
							}
						}
					});
				}
			});
		});
		</script>
	</head>
	<body>
		<div class="container-narrow">
			<div class="masthead">
				<ul class="nav nav-pills pull-right">
					<li><a href="/">Home</a></li>
					<li><a href="/about">About</a></li>
					<li><a href="mailto:licson0729@gmail.com">Contact</a></li>
				</ul>
			<h3 class="muted">PollEndpoint</h3>
		</div>
		<hr>
		<div class="jumbotron" itemscope itemtype="http://schema.org/WPHeader">
			<h1 itemprop="name"><%= meta[0].name %></h1>
			<p class="lead" itemprop="description"><%= meta[0].desc %></p>
		</div>
		<hr>
		<div>
			<a class="btn pull-right" href="../stats/<%= id %>">Statistics</a>
			<h2>Questions</h2>
			<form action="./<%= id %>/submit" method="POST" id="answer">
				<%
				for(var i = 0; i < questions.length; i++){
					var q = questions[i];
				%>
				<div class="question" data-id="<%= q.id %>">
					<p class="lead"><span><%= i+1 %>.</span> <%= q.name %></p>
					<% 
					switch(q.type){
						case "fillin":
					%>
					<input type="text" name="<%= q.id %>" placeholder="Type here..." class="<%= q.required ? 'required' : '' %>"/>
					<% 	break;
						
						case "mc":
						var choices = q.choices.split(',');
						
						for(var j = 0; j < choices.length; j++){
							var choice = choices[j];
					%>
					<label for="<%= q.id+'_'+j %>" class="radio">
						<input type="radio" name="<%= q.id %>" id="<%= q.id+'_'+j %>" value="<%= choice %>" class="<%= q.required ? 'required' : '' %>"/> <%= choice %>
					</label>
					<%
						}
						break;
						
						case "mmc":
						var choices = q.choices.split(',');
						
						for(var j = 0; j < choices.length; j++){
							var choice = choices[j];
					%>
					<label for="<%= q.id+'_'+j %>" class="checkbox">
						<input type="checkbox" name="<%= q.id %>[]" id="<%= q.id+'_'+j %>" value="<%= choice %>" class="<%= q.required ? 'required' : '' %>"/> <%= choice %>
					</label>
					<%
						}
						break;
					}
					%>
				</div>
				<% } %>
				<button class="btn btn-large">Submit</button>
			</form>
		</div>
		<hr>
		<div class="footer">
			<p>&copy; PollEndpoint <%= '2013 - ' + (new Date).getFullYear() == 2013 ? '' : (new Date).getFullYear() %></p>
		</div>
	</body>
</html>